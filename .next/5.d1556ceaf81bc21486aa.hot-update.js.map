{"version":3,"file":"5.d1556ceaf81bc21486aa.hot-update.js","sources":["webpack:///pages/order.js"],"sourcesContent":["/**\n * Created by pdd on 2018/6/9.\n */\n\nimport React from 'react';\nimport './order.scss';\nimport request from './request';\n// import { getCookie } from './util';\nimport cookies from 'next-cookies';\nimport Router from 'next/router';\nimport data  from '../data';\nconst { orderData } = data;\n\n\n\nexport default class Order extends React.Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            orderInfo: {\n                // order_date: '2018.6.7',\n                // order_path: '旅游1线',\n                // order_station: '南门换乘车站',\n                // order_class: '9:00',\n                // order_ticket_count: 2,\n                // order_owner: '曾超',\n                // order_mobile: '13636672480',\n                order_date: '',\n                order_path: '',\n                order_station: '',\n                order_class: '',\n                order_ticket_count: 1,\n                // order_owner: getCookie('username'),\n                // order_mobile: getCookie('mobile'),\n\n            },\n        }\n        window.doc\n    }\n\n    static async getInitialProps (ctx) {\n        const { mobile, username } = cookies(ctx);\n        console.log('mobile:', mobile);\n        const { res } = ctx;\n        if (res) {\n            if (!mobile) {\n                res.writeHead(302, {\n                    Location: '/login'\n                })\n                res.end()\n                res.finished = true\n            }\n        } else {\n            if (!mobile) {\n                Router.push('/login');\n            }\n        }\n        return {\n            mobile, username\n        }\n    }\n\n    renderSuccess = () => {\n        const {\n            order_date,\n            order_path,\n            order_station,\n            order_class,\n            order_ticket_count,\n            order_owner,\n            order_mobile\n\n        } = this.state.orderInfo;\n\n        return (\n            <div className=\"order-success-page\">\n                <div className=\"log\"/>\n                <div className=\"success-title\">提交成功</div>\n                <div className=\"content\">\n                    <div className=\"title\">预订信息</div>\n                    <div>选择日期：{order_date}</div>\n                    <div>选择线路：{order_path}</div>\n                    <div>选择站点：{order_station}</div>\n                    <div>选择班次：{order_class}</div>\n                    <div>选择张数：{order_ticket_count}</div>\n                    <div>预订人：{order_owner}</div>\n                    <div>手机号：{order_mobile}</div>\n                </div>\n            </div>\n        )\n    }\n\n    submit = () => {\n        request.post('/cbo/addOrder', this.state.orderInfo).then(response => {\n\n        }).catch(error => {\n\n        });\n    }\n\n    // selectPath = (order_path) => {\n    //     const orderInfo = {...this.state.orderInfo, order_path}\n    //     this.setState({ orderInfo });\n    // }\n    //\n    // selectStation = (order_station) => {\n    //     const orderInfo = {...this.state.orderInfo, order_station}\n    //     this.setState({ orderInfo });\n    // }\n\n    renderStationsSelect = () => {\n        const selectPath = orderData.filter(path => path.name === this.state.orderInfo.order_path );\n        if (selectPath && selectPath.length > 0) {\n            return selectPath[0].stations.map(station => {\n                return <option key={station.name} value={station.name}>{station.name}</option>\n            })\n        }\n        return null\n    }\n\n    renderClsSelect = () => {\n        const selectPath = orderData.filter(path => path.name === this.state.orderInfo.order_path );\n        if (selectPath && selectPath.length > 0) {\n            const stations = selectPath[0].stations;\n            // console.log(selectPath, '1112')\n            // console.log(stations, '111')\n            const selectStations = stations.filter(station => station.name === this.state.orderInfo.order_station);\n            if (selectStations && selectStations.length > 0) {\n                const classes = selectStations[0].classes;\n                return classes.map(cls => {\n                    return <option key={cls.time} value={cls.time}>{cls.time}</option>\n                })\n            }\n\n        }\n        return null\n    }\n\n    renderOrder = () => {\n        const {\n            order_date,\n            order_path,\n            order_station,\n            order_class,\n            order_ticket_count,\n            order_owner,\n            order_mobile\n\n        } = this.state.orderInfo;\n\n        return (\n            <div className=\"order-page\">\n                <div className=\"form-content\">\n                    <div className=\"item\">\n                        <span>选择日期</span>\n                        <input type='date' value={order_date} onChange={(e) => {\n                            this.setState({ orderInfo: {...this.state.orderInfo, order_date: e.target.value }});\n                        }} />\n                    </div>\n\n                    <div className=\"item\">\n                        <span>选择路线</span>\n                        <select value={order_path} onChange={(e) => {\n                            this.setState({ orderInfo: {...this.state.orderInfo, order_path: e.target.value }});\n                        }}>\n                            {\n                                orderData.map(path => {\n                                    return (\n                                        <option key={path.name} value={path.name}>{path.name}</option>\n                                    )\n                                })\n                            }\n                        </select>\n                    </div>\n\n                    <div className=\"item\">\n                        <span>选择站点</span>\n                        <select value={order_station} onChange={(e) => {\n                            this.setState({ orderInfo: {...this.state.orderInfo, order_station: e.target.value }});\n                        }}>\n                            {\n                                this.renderStationsSelect()\n                            }\n                        </select>\n                    </div>\n\n                    <div className=\"item\">\n                        <span>选择班次</span>\n                        <select value={order_class} onChange={(e) => {\n                            this.setState({ orderInfo: {...this.state.orderInfo, order_class: e.target.value }});\n                        }}>\n                            {\n                                this.renderClsSelect()\n                            }\n                        </select>\n                    </div>\n\n                    <div className=\"item\">\n                        <span>座位预订</span>\n                        <select value={order_ticket_count} onChange={(e) => {\n                            this.setState({ orderInfo: {...this.state.orderInfo, order_ticket_count: e.target.value }});\n                        }}>\n                            <option value=\"1\">1人</option>\n                            <option value=\"2\">2人</option>\n                            <option value=\"3\">3人</option>\n                            <option value=\"4\">4人</option>\n                        </select>\n                    </div>\n\n                    <div className=\"tip\">请仔细核对预约信息</div>\n\n                    <button className=\"submit\" onClick={this.submit}>提交</button>\n                    <div className={1}>\n\n\n                    </div>\n\n                </div>\n            </div>\n        )\n    }\n\n    render () {\n        // return this.renderSuccess();\n        return this.renderOrder();\n    }\n}\n\n\n// WEBPACK FOOTER //\n// pages/order.js"],"mappings":"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","sourceRoot":""}