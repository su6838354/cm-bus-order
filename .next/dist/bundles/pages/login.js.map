{"version":3,"file":"bundles/pages/login.js","sources":["webpack:///webpack/bootstrap 554102dba8c33b6fbbd6","webpack:///pages/login.js","webpack:///pages/request.js","webpack:///external \"axios\"","webpack:///external \"next/router\"","webpack:///external \"react\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tvar threw = true;\n \t\ttry {\n \t\t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n \t\t\tthrew = false;\n \t\t} finally {\n \t\t\tif(threw) delete installedModules[moduleId];\n \t\t}\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 554102dba8c33b6fbbd6","/**\n * Created by pdd on 2018/6/9.\n */\n\nimport React from 'react';\nimport Router from 'next/router';\nimport request from './request';\nimport './login.scss';\n\n\nfunction setCookie(c_name,value,expiredays)\n{\n    var exdate=new Date()\n    exdate.setDate(exdate.getDate()+expiredays)\n    document.cookie=c_name+ \"=\" +escape(value)+\n        ((expiredays==null) ? \"\" : \";expires=\"+exdate.toGMTString())\n}\n\nexport default class Login extends React.Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            username: '',\n            mobile: '',\n            yanzhema: '',\n            reSecond: 0,\n            msg: '',\n        }\n    }\n\n\n    login = () => {\n        const {\n            username,\n            mobile,\n            yanzhema,\n        } = this.state;\n\n        request.post('/cbo/login', {\n            username,\n            mobile,\n            yanzhema,\n        }).then(response => {\n            const code = response.data.code;\n            if (code === 0) {\n                setCookie('mobile', mobile, 7);\n                setCookie('username', username, 7);\n                this.setState({\n                  msg: '登录成功'\n                });\n                window.setTimeout(() => {\n                    Router.push('/main');\n                }, 300);\n            } else if (code === 1001) {\n                alert('验证码错误');\n            }\n        }).catch(error => {\n            console.log(error);\n        });\n    }\n\n    sendCode = () => {\n        const { mobile, username } = this.state;\n        const reg = /^1[3|4|5|7|8][0-9]{9}$/; //验证规则\n\n        if (!username) {\n            alert('姓名不能为空');\n            return;\n        }\n        const flag = reg.test(mobile); //true\n        if (flag) {\n            request.post('/cbo/sendCode', {\n                mobile\n            })\n                .then((response) => {\n                    console.log(response);\n                    if (response.data.code === 0) {\n                        let i = 10;\n                        const start = () => {\n                            if (i === 0) {\n                                return;\n                            }\n                            i = i - 1;\n                            this.setState({ reSecond: i });\n                            window.setTimeout(() => {\n                                start();\n                            }, 1000);\n                        };\n\n                        start()\n\n                    }\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        } else  {\n            alert('请输入正确手机号码');\n        }\n\n    }\n\n    render () {\n        return (\n            <div className=\"login-page\">\n                <div className=\"log\" />\n\n                <input className=\"btn\" onChange={e => {\n                    this.setState({username: e.target.value})\n                }} placeholder=\"预订姓名\" />\n                <input className=\"btn mobile\" onChange={e => {\n                    this.setState({mobile: e.target.value})\n                }}  placeholder=\"预订手机号\" />\n                <div className=\"yanzhengma\">\n                    <input className=\"input-yanzhengma\" onChange={e => {\n                        this.setState({yanzhema: e.target.value})\n                    }} placeholder=\"输入验证码\"/>\n                    <button disabled={this.state.reSecond !== 0} className=\"btn getyanzhengma\" onClick={this.sendCode}>\n                        {\n                            this.state.reSecond === 0 ?\n                                <span>获取验证码</span>\n                                :\n                                <span>{this.state.reSecond}s</span>\n                        }\n                    </button>\n                </div>\n                <button className=\"login-btn\" onClick={this.login}>登录</button>\n\n                <div className='msg'>{this.state.msg}</div>\n            </div>\n        )\n    }\n}\n\n\n// WEBPACK FOOTER //\n// pages/login.js","import axios from 'axios'\n// import store from '@/store'\n// import { getToken } from '@/utils/auth'\n\n// 创建axios实例\nconst service = axios.create({\n  baseURL: 'http://139.196.243.147:3002', // api的base_url\n  timeout: 10000 // 请求超时时间\n})\n\n// request拦截器\nservice.interceptors.request.use(config => {\n  // Do something before request is sent\n  // if (store.getters.token) {\n  //   config.headers['X-Token'] = getToken() // 让每个请求携带token--['X-Token']为自定义key 请根据实际情况自行修改\n  // }\n  return config\n}, error => {\n  console.log(error) // for debug\n  message.error(error.message)\n  Promise.reject(error)\n})\n\n// respone拦截器\n// service.interceptors.response.use(\n//   ({ data, config, status }) => {\n//     if (config.method === 'delete' && status === 204) {\n//       return {data, code: 0, message: 'delete success'}\n//     } else if (data.code !== 0) {\n//       message.error(data.message)\n//       return Promise.reject(new Error(data))\n//     } else {\n//       return data\n//     }\n//   },\n//   /**\n//   * 下面的注释为通过response自定义code来标示请求状态，当code返回如下情况为权限有问题，登出并返回到登录页\n//   * 如通过xmlhttprequest 状态码标识 逻辑可写在下面error中\n//   */\n//   //  const res = response.data;\n//   //     if (res.code !== 20000) {\n//   //       Message({\n//   //         message: res.message,\n//   //         type: 'error',\n//   //         duration: 5 * 1000\n//   //       });\n//   //       // 50008:非法的token; 50012:其他客户端登录了;  50014:Token 过期了;\n//   //       if (res.code === 50008 || res.code === 50012 || res.code === 50014) {\n//   //         MessageBox.confirm('你已被登出，可以取消继续留在该页面，或者重新登录', '确定登出', {\n//   //           confirmButtonText: '重新登录',\n//   //           cancelButtonText: '取消',\n//   //           type: 'warning'\n//   //         }).then(() => {\n//   //           store.dispatch('FedLogOut').then(() => {\n//   //             location.reload();// 为了重新实例化vue-router对象 避免bug\n//   //           });\n//   //         })\n//   //       }\n//   //       return Promise.reject('error');\n//   //     } else {\n//   //       return response.data;\n//   //     }\n//   error => {\n//     console.log('err' + error)// for debug\n//     message.error(error.message)\n//     return Promise.reject(error)\n//   })\n\nexport default service\n\n\n\n// WEBPACK FOOTER //\n// pages/request.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = axios\n// module chunks = 3 4","module.exports = require(\"next/router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/router\"\n// module id = next/router\n// module chunks = 3 4","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = react\n// module chunks = 0 3 4"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnEA;;;AAIA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxCA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0CA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AADA;AAIA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAjFA;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AAFA;AASA;AACA;;;AAyEA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;AAjHA;AACA;;;;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACpEA;;;;;;;ACAA;;;;;;;ACAA;;;;A","sourceRoot":""}